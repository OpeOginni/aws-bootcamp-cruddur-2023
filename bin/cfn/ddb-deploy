#! /usr/bin/env bash
set -e #stops the execution of the script if it fails

FUN_DIR="/workspace/aws-bootcamp-cruddur-2023/aws/lambdas/cruddur-messaging-stream/"
TEMPLATE_PATH="/workspace/aws-bootcamp-cruddur-2023/aws/cfn/ddb/template.yaml"
CONFIG_PATH="/workspace/aws-bootcamp-cruddur-2023/aws/cfn/ddb/config.toml"
ARTIFACT_BUCKET="cfn-artifacts"

sam build \
--config-file $CONFIG_PATH \
--template-file $TEMPLATE_PATH\
--build-dir $FUN_DIR \
--base-dir $FUN_DIR \
# --parameter-overrides 

sam package \
  --s3-bucket $ARTIFACT_BUCKET \
  --config-file $CONFIG_PATH \
  --template-file $TEMPLATE_PATH
